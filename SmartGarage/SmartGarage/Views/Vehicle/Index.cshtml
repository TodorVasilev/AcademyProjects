@model PaginatedList<GetVehicleDTO>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<body>
    <div class="container mt-3 pt-2" style="background-color:#212529;">
        @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
        {
            <p class="text-white p-1">
                <input type="submit" value="Search" class="btn btn-outline-success" id="search" />
                <input type="text" name="name" placeholder="Search by Name" id="name" />
                <a onclick="showInPopup('@Url.Action("Create", "Vehicle",null, Context.Request.Scheme)', 'Create Vehhicle')" class="btn btn-outline-success float-right text-white">Create New</a>
            </p>
        }
        else
        {
            <p class=""></p>
        }
        <div id="partialView">
            <partial name="Vehicle_Table_Partial" model="@Model" />
        </div>
    </div>
</body>

@section Scripts {
    <script>
        $(document).ready(function () {
            $(document).on("click", "#search", function () {
                var name = $('#name').val();
                $.ajax({
                    url: "/Vehicle/Filter",
                    type: "GET",
                    data: {
                        name: name
                    }
                })
                    .done(function (partialViewResult) {
                        $("#partialView").html(partialViewResult);
                    });
            });
            $(document).on("click", "#next", function () {
                var name = $('#name').val();
                var page = $('#page').val();
                $.ajax({
                    url: "/Vehicle/Filter",
                    type: "GET",
                    data: {
                        name: name,
                        pageNumber: parseInt(page) + 1
                    }
                })
                    .done(function (partialViewResult) {
                        $("#partialView").html(partialViewResult);
                    });
            });
            $(document).on("click", "#prev", function () {
                var name = $('#name').val();
                var page = $('#page').val();
                $.ajax({
                    url: "/Vehicle/Filter",
                    type: "GET",
                    data: {
                        name: name,
                        pageNumber: parseInt(page) - 1
                    }
                })
                    .done(function (partialViewResult) {
                        $("#partialView").html(partialViewResult);
                    });
            });
        });
    </script>
}  